[TOC]

### 1. 样例程序

```python
import tensorflow as tf
import timeit

# CPU环境下
with tf.device('/cpu:0'):
    cpu_a = tf.random.normal([10000, 1000])
    cpu_b = tf.random.normal([1000, 2000])
    print(cpu_a.device, cpu_b.device)

# GPU环境下
with tf.device('/gpu:0'):
    gpu_a = tf.random.normal([10000, 1000])
    gpu_b = tf.random.normal([1000, 2000])
    print(gpu_a.device, gpu_b.device)

# 使用CPU执行矩阵相乘运算
def cpu_run():
    with tf.device('/cpu:0'):
        c = tf.matmul(cpu_a, cpu_b)
    return c

# 使用GPU执行矩阵相乘运算
def gpu_run():
    with tf.device('/gpu:0'):
        c = tf.matmul(gpu_a, gpu_b)
    return c

# 先完成GPU的热身：因为在做GPU运算的时候，会先进行环境的初始化配置工作，所以避免把这部分时间算到实际运行时间中。
cpu_time = timeit.timeit(cpu_run, number=10)  # 重复进行10次矩阵相乘
gpu_time = timeit.timeit(gpu_run, number=10)  # 重复进行10次矩阵相乘
print("热身时间：", cpu_time, gpu_time)

# 正式计时
cpu_time = timeit.timeit(cpu_run, number=10)  # 重复进行10次矩阵相乘
gpu_time = timeit.timeit(gpu_run, number=10)  # 重复进行10次矩阵相乘
print("实际运行时间：", cpu_time, gpu_time)
```

### 2. 运行结果
热身时间：4.032514600000001 0.2416103180000002
实际运行时间：4.121906190999999 0.0011046439999997